# Spread of Disease Model Experiments

## Overview

This document tests `logolink` under the different experiments using the *Spread of Disease* model, included in NetLogo along with the [IABM Textbook](https://mitpress.mit.edu/9780262731898/an-introduction-to-agent-based-modeling/) library.

## Set the Environment

### Load Packages

```{r}
#| label: Set the Environment
#| output: false

library(dplyr)
library(logolink)
```

### Set Model Path

```{r}
model_path <-
  find_netlogo_home() |>
  file.path(
    "models",
    "IABM Textbook",
    "chapter 6",
    "Spread of Disease.nlogox"
  )
```

## Custom Experiments

### Population Density (Runtime)

#### Create Experiment

```{r}
#| label: Population Density (Runtime)

setup_file <- create_experiment(
  name = "Population Density (Runtime)",
  repetitions = 10,
  sequential_run_order = TRUE,
  run_metrics_every_step = TRUE,
  time_limit = 1000,
  setup = 'setup',
  go = 'go',
  metrics = 'count turtles with [infected?]',
  constants = list(
    "variant" = "mobile",
    "num-people" = list(
      first = 50,
      step = 50,
      last = 200
    ),
    "connections-per-node" = 4.1,
    "num-infected" = 1,
    "disease-decay" = 0
  )
)
```

```{r}
setup_file |> inspect_experiment_file()
```

#### Run Experiment

```{r}
results <-
  model_path |>
  run_experiment(
    setup_file = setup_file
  )
```

```{r}
results |> glimpse()
```

## Predefined Experiments

### Population Density

#### Create Experiment

```{r}
#| label: Population Density

setup_file <- create_experiment(
  name = "Population Density",
  repetitions = 10,
  sequential_run_order = TRUE,
  run_metrics_every_step = FALSE,
  time_limit = NULL,
  setup = 'setup',
  go = 'go',
  metrics = 'ticks',
  constants = list(
    "variant" = "mobile",
    "connections-per-node" = 4.1,
    "num-people" = list(
      first = 50,
      step = 50,
      last = 200
    ),
    "num-infected" = 1,
    "disease-decay" = 0
  )
)
```

```{r}
setup_file |> inspect_experiment_file()
```

#### Define Experiment Name

```{r}
experiment <- "population-density"
```

#### Run Experiment

```{r}
results <-
  model_path |>
  run_experiment(
    experiment = experiment
  )
```

```{r}
results |> glimpse()
```

### Degree

#### Create Experiment Mirror

```{r}
#| label: Degree

setup_file <- create_experiment(
  name = "Degree",
  repetitions = 10,
  sequential_run_order = TRUE,
  run_metrics_every_step = FALSE,
  time_limit = 50,
  setup = 'setup',
  go = 'go',
  metrics = 'count turtles with [infected?]',
  constants = list(
    "num-people" = 200,
    "connections-per-node" = list(
      first = 0.5,
      step = 0.5,
      last = 4
    ),
    "disease-decay" = 10,
    "variant" = "network",
    "num-infected" = 1
  )
)
```

```{r}
inspect_experiment_file(setup_file)
```

#### Define Experiment Name

```{r}
experiment <- "degree"
```

#### Run Experiment

```{r}
results <-
  model_path |>
  run_experiment(
    experiment = experiment
  )
```

```{r}
results |> glimpse()
```

### Environmental

#### Create Experiment Mirror

```{r}
#| label: Environmental

setup_file <- create_experiment(
  name = "Environmental",
  repetitions = 10,
  sequential_run_order = TRUE,
  run_metrics_every_step = FALSE,
  time_limit = NULL,
  setup = 'setup',
  go = 'go',
  metrics = 'ticks',
  constants = list(
    "num-people" = 200,
    "connections-per-node" = 4,
    "disease-decay" = list(
      first = 0,
      step = 1,
      last = 10
    ),
    "variant" = "environmental",
    "num-infected" = 1
  )
)
```

```{r}
inspect_experiment_file(setup_file)
```

#### Define Experiment Name

```{r}
experiment <- "environmental"
```

#### Run Experiment

```{r}
results <-
  model_path |>
  run_experiment(
    experiment = experiment
  )
```

```{r}
results |> glimpse()
```

### Density and Decay

#### Create Experiment Mirror

```{r}
#| label: Density and Decay

setup_file <- create_experiment(
  name = "Density and Decay",
  repetitions = 10,
  sequential_run_order = TRUE,
  run_metrics_every_step = FALSE,
  time_limit = NULL,
  setup = 'setup',
  go = 'go',
  metrics = 'ticks',
  constants = list(
    "variant" = "environmental",
    "disease-decay" = list(
      first = 0,
      step = 1,
      last = 10
    ),
    "num-infected" = 1,
    "num-people" = list(
      first = 50,
      step = 50,
      last = 200
    ),
    "connections-per-node" = 4
  )
)
```

```{r}
inspect_experiment_file(setup_file)
```

#### Define Experiment Name

```{r}
experiment <- "density-and-decay"
```

#### Run Experiment

```{r}
results <-
  model_path |>
  run_experiment(
    experiment = experiment
  )
```

```{r}
results |> glimpse()
```
